{
  "version": 3,
  "sources": ["../../../src/component/event-listeners/selection-change-compat.js"],
  "sourcesContent": ["/**\n * Internal dependencies\n */\nimport { isRangeEqual } from '../../is-range-equal';\n\n/**\n * Sometimes some browsers are not firing a `selectionchange` event when\n * changing the selection by mouse or keyboard. This hook makes sure that, if we\n * detect no `selectionchange` or `input` event between the up and down events,\n * we fire a `selectionchange` event.\n */\nexport default () => ( element ) => {\n\tconst { ownerDocument } = element;\n\tconst { defaultView } = ownerDocument;\n\tconst selection = defaultView?.getSelection();\n\n\tlet range;\n\n\tfunction getRange() {\n\t\treturn selection.rangeCount ? selection.getRangeAt( 0 ) : null;\n\t}\n\n\tfunction onDown( event ) {\n\t\tconst type = event.type === 'keydown' ? 'keyup' : 'pointerup';\n\n\t\tfunction onCancel() {\n\t\t\townerDocument.removeEventListener( type, onUp );\n\t\t\townerDocument.removeEventListener( 'selectionchange', onCancel );\n\t\t\townerDocument.removeEventListener( 'input', onCancel );\n\t\t}\n\n\t\tfunction onUp() {\n\t\t\tonCancel();\n\t\t\tif ( isRangeEqual( range, getRange() ) ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\townerDocument.dispatchEvent( new Event( 'selectionchange' ) );\n\t\t}\n\n\t\townerDocument.addEventListener( type, onUp );\n\t\townerDocument.addEventListener( 'selectionchange', onCancel );\n\t\townerDocument.addEventListener( 'input', onCancel );\n\n\t\trange = getRange();\n\t}\n\n\telement.addEventListener( 'pointerdown', onDown );\n\telement.addEventListener( 'keydown', onDown );\n\treturn () => {\n\t\telement.removeEventListener( 'pointerdown', onDown );\n\t\telement.removeEventListener( 'keydown', onDown );\n\t};\n};\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA,4BAA6B;AAQ7B,IAAO,kCAAQ,MAAM,CAAE,YAAa;AACnC,QAAM,EAAE,cAAc,IAAI;AAC1B,QAAM,EAAE,YAAY,IAAI;AACxB,QAAM,YAAY,aAAa,aAAa;AAE5C,MAAI;AAEJ,WAAS,WAAW;AACnB,WAAO,UAAU,aAAa,UAAU,WAAY,CAAE,IAAI;AAAA,EAC3D;AAEA,WAAS,OAAQ,OAAQ;AACxB,UAAM,OAAO,MAAM,SAAS,YAAY,UAAU;AAElD,aAAS,WAAW;AACnB,oBAAc,oBAAqB,MAAM,IAAK;AAC9C,oBAAc,oBAAqB,mBAAmB,QAAS;AAC/D,oBAAc,oBAAqB,SAAS,QAAS;AAAA,IACtD;AAEA,aAAS,OAAO;AACf,eAAS;AACT,cAAK,oCAAc,OAAO,SAAS,CAAE,GAAI;AACxC;AAAA,MACD;AACA,oBAAc,cAAe,IAAI,MAAO,iBAAkB,CAAE;AAAA,IAC7D;AAEA,kBAAc,iBAAkB,MAAM,IAAK;AAC3C,kBAAc,iBAAkB,mBAAmB,QAAS;AAC5D,kBAAc,iBAAkB,SAAS,QAAS;AAElD,YAAQ,SAAS;AAAA,EAClB;AAEA,UAAQ,iBAAkB,eAAe,MAAO;AAChD,UAAQ,iBAAkB,WAAW,MAAO;AAC5C,SAAO,MAAM;AACZ,YAAQ,oBAAqB,eAAe,MAAO;AACnD,YAAQ,oBAAqB,WAAW,MAAO;AAAA,EAChD;AACD;",
  "names": []
}
